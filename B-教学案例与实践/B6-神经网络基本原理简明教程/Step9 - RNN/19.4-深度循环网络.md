<!--Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/Microsoft/ai-edu/blob/master/LICENSE.md)版权许可-->

## 19.4 深度循环网络



<img src="../Images/19/deep_rnn_net.png"/>
<img src="../Images/19/deep_rnn_loss.png"/>
<img src="../Images/19/deep_rnn_result.png"/>


参数量计算

对于19.3节中的单层RNN，参数配置如下：

|参数|尺寸|数量|
|---|---|---|
|U|26x8|208|
|V|8x6|48|
|W|8x8|64|
|Total||320|

对于两层的RNN来说，参数配置如下：

|参数|尺寸|数量|
|---|---|---|
|U|26x4|104|
|Q|4x4|26|
|V|4x6|24|
|W1|4x4|16|
|W2|4x4|16|
|Total||156|

通过上面两张表的比较，可以看出，单层RNN的参数总量为320个，双层RNN（代表了深度RNN）的参数总量为156个，只有前者的一半，但是可以达到同样的效果，甚至更好的效果。


```
129:285220:0.0005 loss=0.924615, acc=0.587000
save parameters...
130:287414:0.0005 loss=0.929041, acc=0.543000
...
149:329100:0.0005 loss=0.935588, acc=0.586000
correctness=5801/8759=0.6622902157780568
```

```
...
64:142610:0.002 loss=0.943880, acc=0.665000
65:144804:0.002 loss=0.832404, acc=0.717000
save parameters...
66:146998:0.002 loss=0.866448, acc=0.723000
...
149:329100:0.0005 loss=0.897896, acc=0.668000
correctness=5939/8759=0.6780454389770522
```